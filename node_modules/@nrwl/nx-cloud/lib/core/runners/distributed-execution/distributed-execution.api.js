const a7_0x4969=['../../../utilities/nx-imports','Starting\x20a\x20distributed\x20execution','mapRespToPerfEntry','createMetricRecorder','__awaiter','true','error','apply','parallel','recordMetric','axiosException','stringify','map','post','dteStart','DistributedExecutionApi','__esModule','dteStatus','axiosMultipleTries','Completing\x20run\x20group\x20with\x20an\x20error','/nx-cloud/executions/complete-run-group','next','VERBOSE_LOGGING','target','message','error:\x20','../../../utilities/axios','configuration','../../../utilities/metric-logger','apiAxiosInstance','hash','response','then','RUNNER_FAILURE_PERF_ENTRY','completeRunGroup','exit','/nx-cloud/executions/start','defineProperty','/nx-cloud/executions/status','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','value','runGroup:\x20','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','data','getBranch','createStartRequest','note','completeRunGroupWithError','parseCommand','createApiAxiosInstance','done','../../../utilities/serializer-overrides','throw','project','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','serializeOverrides'];(function(_0xff627c,_0x4969d7){const _0xa8bffc=function(_0xd3a50e){while(--_0xd3a50e){_0xff627c['push'](_0xff627c['shift']());}};_0xa8bffc(++_0x4969d7);}(a7_0x4969,0xa7));const a7_0xa8bf=function(_0xff627c,_0x4969d7){_0xff627c=_0xff627c-0x0;let _0xa8bffc=a7_0x4969[_0xff627c];return _0xa8bffc;};'use strict';var __awaiter=this&&this[a7_0xa8bf('0x5')]||function(_0x4ef647,_0x37cf5c,_0x3454fa,_0x56fa47){function _0x1cd8fb(_0x2fdd5b){return _0x2fdd5b instanceof _0x3454fa?_0x2fdd5b:new _0x3454fa(function(_0x3dd9da){_0x3dd9da(_0x2fdd5b);});}return new(_0x3454fa||(_0x3454fa=Promise))(function(_0x28eac7,_0x185a0b){function _0x4d765c(_0x31d272){try{_0x575995(_0x56fa47[a7_0xa8bf('0x16')](_0x31d272));}catch(_0x262f2a){_0x185a0b(_0x262f2a);}}function _0xaa570e(_0x37d3fc){try{_0x575995(_0x56fa47[a7_0xa8bf('0x35')](_0x37d3fc));}catch(_0x5ccd55){_0x185a0b(_0x5ccd55);}}function _0x575995(_0xacc4a6){_0xacc4a6[a7_0xa8bf('0x33')]?_0x28eac7(_0xacc4a6[a7_0xa8bf('0x29')]):_0x1cd8fb(_0xacc4a6[a7_0xa8bf('0x29')])[a7_0xa8bf('0x21')](_0x4d765c,_0xaa570e);}_0x575995((_0x56fa47=_0x56fa47[a7_0xa8bf('0x8')](_0x4ef647,_0x37cf5c||[]))[a7_0xa8bf('0x16')]());});};Object[a7_0xa8bf('0x26')](exports,a7_0xa8bf('0x11'),{'value':!![]});exports[a7_0xa8bf('0x2e')]=exports['DistributedExecutionApi']=void 0x0;const axios_1=require(a7_0xa8bf('0x1b'));const environment_1=require('../../../utilities/environment');const metric_logger_1=require(a7_0xa8bf('0x1d'));const serializer_overrides_1=require(a7_0xa8bf('0x34'));const {output}=require(a7_0xa8bf('0x1'));class DistributedExecutionApi{constructor(_0x4fe3d4){this[a7_0xa8bf('0x1e')]=(0x0,axios_1[a7_0xa8bf('0x32')])(_0x4fe3d4);}['start'](_0x43859c){var _0x3a21dc;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5da9eb=(0x0,metric_logger_1[a7_0xa8bf('0x4')])(a7_0xa8bf('0xf'));let _0x2b94e7;if(environment_1[a7_0xa8bf('0x17')]){output[a7_0xa8bf('0x2f')]({'title':a7_0xa8bf('0x2'),'bodyLines':[JSON[a7_0xa8bf('0xc')](_0x43859c,null,0x2)]});}try{_0x2b94e7=yield(0x0,axios_1[a7_0xa8bf('0x13')])(()=>this[a7_0xa8bf('0x1e')][a7_0xa8bf('0xe')](a7_0xa8bf('0x25'),_0x43859c));_0x5da9eb['recordMetric']((0x0,metric_logger_1[a7_0xa8bf('0x3')])(_0x2b94e7));}catch(_0x64dac6){_0x5da9eb['recordMetric'](((_0x3a21dc=_0x64dac6===null||_0x64dac6===void 0x0?void 0x0:_0x64dac6[a7_0xa8bf('0xb')])===null||_0x3a21dc===void 0x0?void 0x0:_0x3a21dc[a7_0xa8bf('0x20')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x64dac6['axiosException'][a7_0xa8bf('0x20')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);throw _0x64dac6;}if(!_0x2b94e7[a7_0xa8bf('0x2c')]['enabled']){throw new Error(a7_0xa8bf('0x28'));}if(_0x2b94e7[a7_0xa8bf('0x2c')][a7_0xa8bf('0x7')]){throw new Error(_0x2b94e7[a7_0xa8bf('0x2c')][a7_0xa8bf('0x7')]);}return _0x2b94e7['data']['id'];});}['status'](_0x3e01f8){var _0x341d56;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x13ec71=(0x0,metric_logger_1[a7_0xa8bf('0x4')])(a7_0xa8bf('0x12'));try{const _0x401c91=yield(0x0,axios_1[a7_0xa8bf('0x13')])(()=>this[a7_0xa8bf('0x1e')][a7_0xa8bf('0xe')](a7_0xa8bf('0x27'),{'id':_0x3e01f8}));_0x13ec71[a7_0xa8bf('0xa')]((0x0,metric_logger_1[a7_0xa8bf('0x3')])(_0x401c91));return _0x401c91[a7_0xa8bf('0x2c')];}catch(_0x3ed688){_0x13ec71[a7_0xa8bf('0xa')](((_0x341d56=_0x3ed688===null||_0x3ed688===void 0x0?void 0x0:_0x3ed688['axiosException'])===null||_0x341d56===void 0x0?void 0x0:_0x341d56['response'])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x3ed688[a7_0xa8bf('0xb')][a7_0xa8bf('0x20')]):metric_logger_1[a7_0xa8bf('0x22')]);output[a7_0xa8bf('0x7')]({'title':_0x3ed688[a7_0xa8bf('0x19')]});process[a7_0xa8bf('0x24')](0x1);}});}[a7_0xa8bf('0x30')](_0x2db85b,_0xdad07){var _0x315715;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x40747f=(0x0,metric_logger_1[a7_0xa8bf('0x4')])(a7_0xa8bf('0x23'));if(environment_1['VERBOSE_LOGGING']){output[a7_0xa8bf('0x2f')]({'title':a7_0xa8bf('0x14'),'bodyLines':[a7_0xa8bf('0x2a')+_0x2db85b,a7_0xa8bf('0x1a')+_0xdad07]});}try{const _0x4f7741=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a7_0xa8bf('0x1e')][a7_0xa8bf('0xe')](a7_0xa8bf('0x15'),{'runGroup':_0x2db85b,'criticalErrorMessage':_0xdad07}),0x3);_0x40747f['recordMetric']((0x0,metric_logger_1[a7_0xa8bf('0x3')])(_0x4f7741));}catch(_0x557c5b){_0x40747f[a7_0xa8bf('0xa')](((_0x315715=_0x557c5b===null||_0x557c5b===void 0x0?void 0x0:_0x557c5b[a7_0xa8bf('0xb')])===null||_0x315715===void 0x0?void 0x0:_0x315715[a7_0xa8bf('0x20')])?(0x0,metric_logger_1[a7_0xa8bf('0x3')])(_0x557c5b['axiosException'][a7_0xa8bf('0x20')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);}});}}exports[a7_0xa8bf('0x10')]=DistributedExecutionApi;function createStartRequest(_0x24b811,_0x5731a4,_0x4d8f37){const _0x86b1de=_0x5731a4[a7_0xa8bf('0xd')](_0x575cc2=>{return _0x575cc2[a7_0xa8bf('0xd')](_0x3a88f2=>{return{'taskId':_0x3a88f2['id'],'hash':_0x3a88f2[a7_0xa8bf('0x1f')],'projectName':_0x3a88f2[a7_0xa8bf('0x18')][a7_0xa8bf('0x36')],'target':_0x3a88f2[a7_0xa8bf('0x18')][a7_0xa8bf('0x18')],'configuration':_0x3a88f2[a7_0xa8bf('0x18')][a7_0xa8bf('0x1c')]||null,'params':(0x0,serializer_overrides_1[a7_0xa8bf('0x0')])(_0x3a88f2)};});});const _0x59e4bc={'command':(0x0,environment_1[a7_0xa8bf('0x31')])(),'branch':(0x0,environment_1[a7_0xa8bf('0x2d')])(),'runGroup':_0x24b811,'tasks':_0x86b1de,'maxParallel':calculateMaxParallel(_0x4d8f37)};if(environment_1[a7_0xa8bf('0x2b')]){_0x59e4bc['agentCount']=environment_1[a7_0xa8bf('0x2b')];}if(!environment_1[a7_0xa8bf('0x37')]){_0x59e4bc['stopAgentsOnFailure']=![];}return _0x59e4bc;}exports[a7_0xa8bf('0x2e')]=createStartRequest;function calculateMaxParallel(_0x460d1b){if(_0x460d1b[a7_0xa8bf('0x9')]==='false'||_0x460d1b[a7_0xa8bf('0x9')]===![]){return 0x1;}else if(_0x460d1b[a7_0xa8bf('0x9')]===a7_0xa8bf('0x6')||_0x460d1b['parallel']===!![]){return Number(_0x460d1b['maxParallel']||0x3);}else if(_0x460d1b[a7_0xa8bf('0x9')]===undefined){return _0x460d1b['maxParallel']?Number(_0x460d1b['maxParallel']):0x3;}else{return Number(_0x460d1b[a7_0xa8bf('0x9')])||0x3;}}